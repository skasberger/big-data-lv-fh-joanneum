<!doctype html>
<html lang="de">
    <head>
        <meta charset="utf-8">
        <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
        <title>Bar Chart</title>

        <script src="https://d3js.org/d3.v4.min.js"></script>
    </head>
    <body>
        <div class="container">
            <h1>Bar Chart</h1>

        </div>

        <script>
            var chartWidth = 600;
            var chartHeight = 400;

            var chart = d3.select('.container')
                    .append('svg')
                    .attr('width', chartWidth)
                    .attr('height', chartHeight)
                    .append('g');

            //step1(); // programmierkonzepte
            step2(); // alles statisch und hardcoded, erklärung ad koordinationsystem, höhe umdrehen
            //step3(); // positionierung und größe relativ, abstand als variable;
                        // höhe als prozentwert verwenden, breite und höhe variieren
                        // farben; hex und rgb kurz erklären; farben ausprobieren
            //step4(); // array; loop; variable länge verwenden
            //step5(); //sortierung, array of objects; beschriftung

            function step1 () {
                // 1.1 sublime text installieren

                // https://sublimetext.com/2

                // 1.2 einleitung

                // Flooh Perlot http://drawingdata.net/

                // Algorithmus

                // „Ein Algorithmus ist eine eindeutige
                // Handlungsvorschrift zur Lösung eines
                // Problem [...]. Algorithmen bestehen aus
                // endlich vielen, wohldefinierten
                // Einzelschritten.“ – Wikipedia: Algorithmus

                // Programmiersprache

                // „Eine Programmiersprache ist eine formale
                // Sprache zur Formulierung von Datenstrukturen
                // und Algorithmen, d. h. von Rechenvorschriften,
                // die von einem Computer ausgeführt werden
                // können. Sie setzen sich aus Anweisungen nach
                // einem vorgegebenen Muster zusammen, der
                // sogenannten Syntax.“ – Wikipedia: Programmiersprache

                // Javascript

                // Javascript ist nicht Java

                // 1.3 die vorlage herunterladen

                // 1.4 console ausgaben

                console.log('Hallo Welt!');

                console.log(42);

                // 1.5 kommentare

                // this is a comment about the next line
                var someCode = 5;
                console.log(someCode);

                //someCode = 7; // auskommentiert
                //console.log(someCode);

                // blockkommentar
                /*
                 var someMoreCode = 7;
                 someMoreCode = 8;
                 console.log(someMoreCode);
                 */

                // 1.6 variablen

                var greeting = 'Hallo Welt!'; // string
                console.log(greeting);

                var answer = 42; // nummer (int)
                console.log(answer);

                var isThereAnError = false; // boolean
                console.log(isThereAnError);

                var anotherAnswer = 23;
                console.log(anotherAnswer);
                anotherAnswer = 25;
                console.log(anotherAnswer);

                var arrayOfNumbers = [ 'peter', 'stefan', 'david' ]; // array
                console.log(arrayOfNumbers);
                console.log(arrayOfNumbers.length);
                console.log(arrayOfNumbers[ 0 ]);
                console.log(arrayOfNumbers[ 1 ]);
                console.log(arrayOfNumbers[ 2 ]);

                var carParts = { doors: 5, wheels: 4 }; // object
                console.log(carParts);
                console.log(carParts.wheels);

                // 1.7 rechnen

                console.log(2 + 3);
                console.log(8 - 5);
                console.log(5 * 5);
                console.log(35 / 7);

                var fiveTimesFive = 5 * 5;
                console.log(fiveTimesFive);

                var concatText = "some text " + "some more text";

                // 1.8 vergleiche

                console.log(5 > 3);
                console.log(4 == 4);
                console.log(5 >= 4);
                console.log(5 != 4); // not equal
                console.log("tree" == "book");

                // 1.9 if else

                if (7 > 5) {
                    console.log('Sieben ist größer als Fünf');
                } else {
                    console.log('Fünf ist größer als Sieben');
                }

                var greatNumber = 45;
                if (greatNumber < 30) {
                    console.log('greatNumber ist kleiner als 30');
                } else {
                    console.log('greatNumber ist größergleich 30');
                }

                // 1.10 schleife

                for (var i = 1; i < 6; i++) {
                    console.log('test: ' + i);
                }

            }

            function step2 () {
                chart.append('rect')
                        .attr('x', 0)
                        .attr('y', 0)
                        .attr('width', 600)
                        .attr('height', 400)
                        .style('fill', 'lightgreen');

                // http://wahl16.bmi.gv.at/1604-0.html
                // https://www.data.gv.at/auftritte/?organisation=bmi
                // https://www.data.gv.at/suche/?search-term=ergebnisse+wahl

                chart.append('rect') // zeichnen eines rechtecks auf dem svg
                        .attr('x', 0) // x-koordinate der linken oberen ecke des rechtecks = 0
                        // y-koordinate = gewünschte grundlinie - wert; ist nötig,
                        // da die ursprungskoordinaten einer grafik immer links oben sind
                        .attr('y', 400 - 18.94)
                        .attr('width', 50) // breite rechteck = 50 pixel
                        .attr('height', 18.94) // höhe rechteck = 18.94pixel = ergebnis
                        .style('fill', 'grey'); // farbe des rechtecks = grau

                chart.append('rect')
                        // der zweite balken wird neben dem ersten balken positioniert:
                        // breite des ersten balkens + 5 pixel abstand
                        .attr('x', 60)
                        .attr('y', 400 - 35.05) // anpassung des werts
                        .attr('width', 50)
                        .attr('height', 35.05)
                        .style('fill', 'grey');

                chart.append('rect')
                        .attr('x', 120)
                        .attr('y', 400 - 11.28)
                        .attr('width', 50)
                        .attr('height', 11.28)
                        .style('fill', 'grey');

                chart.append('rect')
                        .attr('x', 180)
                        .attr('y', 400 - 11.12)
                        .attr('width', 50)
                        .attr('height', 11.12)
                        .style('fill', 'grey');

                chart.append('rect')
                        .attr('x', 240)
                        .attr('y', 400 - 2.26)
                        .attr('width', 50)
                        .attr('height', 2.26)
                        .style('fill', 'grey');

                chart.append('rect')
                        .attr('x', 300)
                        .attr('y', 400 - 21.34)
                        .attr('width', 50)
                        .attr('height', 21.34)
                        .style('fill', 'grey');
            }

            function step3 () {
                chart.append('rect')
                        .attr('x', 0)
                        .attr('y', 0)
                        .attr('width', chartWidth)
                        .attr('height', chartHeight)
                        .style('fill', 'lightgreen');

                var spaceWidth = 10; // abstand als variable definieren - damit kann man den wert leicht ändern
                var barWidth = 50;
                barWidth = chartWidth / 6 - spaceWidth; // breite der balken im verhältnis zur breite des svg berechnen

                chart.append('rect')
                        .attr('x', 0)
                        .attr('y', chartHeight - chartHeight * 18.94 / 100)
                        .attr('width', barWidth)
                        .attr('height', chartHeight * 18.94 / 100)
                        .style('fill', '#8E88A7'); // farben

                chart.append('rect')
                        // alle angaben bleiben gleich wie bei step_1,
                        // nur ersetzen wir die zahlen durch die neuen variablen
                        .attr('x', barWidth + spaceWidth)
                        .attr('y', chartHeight - chartHeight * 35.05 / 100)
                        .attr('width', barWidth)
                        // die höhe des balkens als prozentwert der gesamthöhe berechnen
                        .attr('height', chartHeight * 35.05 / 100)
                        .style('fill', '#2657A8');

                chart.append('rect')
                        .attr('x', 2 * (barWidth + spaceWidth))
                        .attr('y', chartHeight - chartHeight * 11.28 / 100)
                        .attr('width', barWidth)
                        .attr('height', chartHeight * 11.28 / 100)
                        .style('fill', '#C83D44');

                chart.append('rect')
                        .attr('x', 3 * (barWidth + spaceWidth))
                        .attr('y', chartHeight - chartHeight * 11.12 / 100)
                        .attr('width', barWidth)
                        .attr('height', chartHeight * 11.12 / 100)
                        .style('fill', '#191919');

                chart.append('rect')
                        .attr('x', 4 * (barWidth + spaceWidth))
                        .attr('y', chartHeight - chartHeight * 2.26 / 100)
                        .attr('width', barWidth)
                        .attr('height', chartHeight * 2.26 / 100)
                        .style('fill', '#E7B500');

                chart.append('rect')
                        .attr('x', 5 * (barWidth + spaceWidth))
                        .attr('y', chartHeight - chartHeight * 21.34 / 100)
                        .attr('width', barWidth)
                        .attr('height', chartHeight * 21.34 / 100)
                        .style('fill', '#89A04F');
            }

            function step4 () {
                chart.append('rect')
                        .attr('x', 0)
                        .attr('y', 0)
                        .attr('width', chartWidth)
                        .attr('height', chartHeight)
                        .style('fill', 'lightgreen');

                // die ergebnisse in einem array speichern - achtung, der erste wert steht immer an position 0
                // http://wahl16.bmi.gv.at/1604-0.html
                var result = [ 18.94, 35.05, 11.28, 11.12, 2.26, 21.34 ];
                // die farben in einem array speichern - achtung, muss gleich geordnet sein wie die ergebnisse
                var colors = [ '#8E88A7', '#2657A8', '#C83D44', '#191919', '#E7B500', '#89A04F' ];

                var spaceWidth = 10;
                // die balkenbreite auf basis der anzahl der werte im array berechnen
                var barWidth = chartWidth / result.length - spaceWidth;

                // for-schleife; zählervariable i festlegen, die schleife läuft solange,
                // solange i kleiner als die länge des array ist
                for (var i = 0; i < result.length; i++) {
                    chart.append('rect')
                            // x-position berechnen
                            .attr('x', i * (barWidth + spaceWidth))
                            // ergebnis an der stelle i im array ergebnis abrufen
                            .attr('y', chartHeight - chartHeight * result[ i ] / 100)
                            .attr('width', barWidth)
                            .attr('height', chartHeight * result[ i ] / 100)
                            .style('fill', colors[ i ]); // farbe an der stelle i im array farbe abrufen
                }
            }

            function step5 () {
                chart.append('rect')
                        .attr('x', 0)
                        .attr('y', 0)
                        .attr('width', chartWidth)
                        .attr('height', chartHeight)
                        .style('fill', 'lightgreen');

                // achtung, zahlen stehen ohne "", der rest mit ""
                // http://wahl16.bmi.gv.at/1604-0.html
                var result = [
                    { 'name': 'Griss', 'percent': 18.94, 'color': '#8E88A7' },
                    { 'name': 'Hofer', 'percent': 35.05, 'color': '#2657A8' },
                    { 'name': 'Hundstorfer', 'percent': 11.28, 'color': '#C83D44' },
                    { 'name': 'Khol', 'percent': 11.12, 'color': '#191919' },
                    { 'name': 'Lugner', 'percent': 2.26, 'color': '#E7B500' },
                    { 'name': 'Van der Bellen', 'percent': 21.34, 'color': '#89A04F' }
                ];

                // sortiert den array, allerdings nicht die farben - aufbau eines neuen arrays,
                // bestehend aus kandidaten-objects, mit den eigenschaften "name", "ergebnis" und farbe
                result.sort(function (a, b) { return a.percent < b.percent; });

                var spaceWidth = 10;
                var barWidth = chartWidth / result.length - spaceWidth;

                for (var i = 0; i < result.length; i++) {
                    chart.append('rect')
                            .attr('x', i * (barWidth + spaceWidth))
                            // ergebnis direkt ansprechen
                            .attr('y', chartHeight - chartHeight * result[ i ].percent / 100)
                            .attr('width', barWidth)
                            .attr('height', chartHeight * result[ i ].percent / 100)
                            .style('fill', result[ i ].color);

                    chart.append('text')
                            // text in die mitte des balkens schieben
                            .attr('x', i * (barWidth + spaceWidth) + barWidth / 2)
                            // etwas über dem balken positionieren
                            .attr('y', chartHeight - chartHeight * result[ i ].percent / 100 - 5)
                            .style('fill', result[ i ].color) // schriftfarbe
                            .style('font-size', '18px') // schriftgröße
                            .style('text-anchor', 'middle') // zentrieren
                            .text(result[ i ].name); // der text an sich
                }
            }


        </script>
    </body>
</html>
